Saving all output to "!!{outputDirectory}!!/input_dynamicserde.q.raw". Enter "record" with no arguments to stop it.
>>>  !run !!{qFileDirectory}!!/input_dynamicserde.q
>>>  CREATE TABLE dest1(a array<int>, b array<string>, c map<string,string>, d int, e string) 
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '1' 
COLLECTION ITEMS TERMINATED BY '2' 
MAP KEYS TERMINATED BY '3' 
LINES TERMINATED BY '10' 
STORED AS TEXTFILE;
No rows affected 
>>>  
>>>  EXPLAIN 
FROM src_thrift 
INSERT OVERWRITE TABLE dest1 SELECT src_thrift.lint, src_thrift.lstring, src_thrift.mstringstring, src_thrift.aint, src_thrift.astring;
'Explain'
'ABSTRACT SYNTAX TREE:'
'  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src_thrift))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME dest1))) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src_thrift) lint)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src_thrift) lstring)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src_thrift) mstringstring)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src_thrift) aint)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL src_thrift) astring)))))'
''
'STAGE DEPENDENCIES:'
'  Stage-1 is a root stage'
'  Stage-5 depends on stages: Stage-1 , consists of Stage-4, Stage-3'
'  Stage-4'
'  Stage-0 depends on stages: Stage-4, Stage-3'
'  Stage-2 depends on stages: Stage-0'
'  Stage-3'
''
'STAGE PLANS:'
'  Stage: Stage-1'
'    Map Reduce'
'      Alias -> Map Operator Tree:'
'        src_thrift '
'          TableScan'
'            alias: src_thrift'
'            Select Operator'
'              expressions:'
'                    expr: lint'
'                    type: array<int>'
'                    expr: lstring'
'                    type: array<string>'
'                    expr: mstringstring'
'                    type: map<string,string>'
'                    expr: aint'
'                    type: int'
'                    expr: astring'
'                    type: string'
'              outputColumnNames: _col0, _col1, _col2, _col3, _col4'
'              File Output Operator'
'                compressed: false'
'                GlobalTableId: 1'
'                table:'
'                    input format: org.apache.hadoop.mapred.TextInputFormat'
'                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
'                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
'                    name: input_dynamicserde.dest1'
''
'  Stage: Stage-5'
'    Conditional Operator'
''
'  Stage: Stage-4'
'    Move Operator'
'      files:'
'          hdfs directory: true'
'          destination: pfile:!!{hive.exec.scratchdir}!!'
''
'  Stage: Stage-0'
'    Move Operator'
'      tables:'
'          replace: true'
'          table:'
'              input format: org.apache.hadoop.mapred.TextInputFormat'
'              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
'              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
'              name: input_dynamicserde.dest1'
''
'  Stage: Stage-2'
'    Stats-Aggr Operator'
''
'  Stage: Stage-3'
'    Map Reduce'
'      Alias -> Map Operator Tree:'
'        pfile:!!{hive.exec.scratchdir}!! '
'            File Output Operator'
'              compressed: false'
'              GlobalTableId: 0'
'              table:'
'                  input format: org.apache.hadoop.mapred.TextInputFormat'
'                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
'                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
'                  name: input_dynamicserde.dest1'
''
''
76 rows selected 
>>>  
>>>  FROM src_thrift 
INSERT OVERWRITE TABLE dest1 SELECT src_thrift.lint, src_thrift.lstring, src_thrift.mstringstring, src_thrift.aint, src_thrift.astring;
'lint','lstring','mstringstring','aint','astring'
No rows selected 
>>>  
>>>  SELECT dest1.* FROM dest1;
'a','b','c','d','e'
'[0, 0, 0]','[0, 0, 0]','{key_0=value_0}','1712634731','record_0'
'[1, 2, 3]','[10, 100, 1000]','{key_1=value_1}','465985200','record_1'
'[2, 4, 6]','[20, 200, 2000]','{key_2=value_2}','-751827638','record_2'
'[3, 6, 9]','[30, 300, 3000]','{key_3=value_3}','477111222','record_3'
'[4, 8, 12]','[40, 400, 4000]','{key_4=value_4}','-734328909','record_4'
'[5, 10, 15]','[50, 500, 5000]','{key_5=value_5}','-1952710710','record_5'
'[6, 12, 18]','[60, 600, 6000]','{key_6=value_6}','1244525190','record_6'
'[7, 14, 21]','[70, 700, 7000]','{key_7=value_7}','-1461153973','record_7'
'[8, 16, 24]','[80, 800, 8000]','{key_8=value_8}','1638581578','record_8'
'[9, 18, 27]','[90, 900, 9000]','{key_9=value_9}','336964413','record_9'
'','','','0',''
11 rows selected 
>>>  
>>>  SELECT dest1.a[0], dest1.b[0], dest1.c['key2'], dest1.d, dest1.e FROM dest1;
'_c0','_c1','_c2','d','e'
'0','0','','1712634731','record_0'
'1','10','','465985200','record_1'
'2','20','','-751827638','record_2'
'3','30','','477111222','record_3'
'4','40','','-734328909','record_4'
'5','50','','-1952710710','record_5'
'6','60','','1244525190','record_6'
'7','70','','-1461153973','record_7'
'8','80','','1638581578','record_8'
'9','90','','336964413','record_9'
'','','','0',''
11 rows selected 
>>>  !record
