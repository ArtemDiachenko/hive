Saving all output to "!!{outputDirectory}!!/global_limit.q.raw". Enter "record" with no arguments to stop it.
>>>  !run !!{qFileDirectory}!!/global_limit.q
>>>  set hive.limit.optimize.enable=true;
No rows affected 
>>>  set hive.limit.optimize.limit.file=2;
No rows affected 
>>>  
>>>  drop table gl_tgt;
No rows affected 
>>>  drop table gl_src1;
No rows affected 
>>>  drop table gl_src2;
No rows affected 
>>>  drop table gl_src_part1;
No rows affected 
>>>  
>>>  
>>>  create table gl_src1 (key int, value string) stored as textfile;
No rows affected 
>>>  load data local inpath '../data/files/srcbucket20.txt' INTO TABLE gl_src1;
No rows affected 
>>>  load data local inpath '../data/files/srcbucket20.txt' INTO TABLE gl_src1;
No rows affected 
>>>  load data local inpath '../data/files/srcbucket20.txt' INTO TABLE gl_src1;
No rows affected 
>>>  
>>>  
>>>  
>>>  
>>>  set hive.limit.row.max.size=100;
No rows affected 
>>>  
>>>  -- need one file
>>>  create table gl_tgt as select key from gl_src1 limit 1;
'key'
No rows selected 
>>>  select * from gl_tgt ORDER BY key ASC;
'key'
'165'
1 row selected 
>>>  -- need two files
>>>  select 'x' as key_new , split(value,',') as value_new from gl_src1 ORDER BY key_new ASC, value_new[0] ASC limit 20;
'key_new','value_new'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_0]'
'x','[val_103]'
'x','[val_103]'
'x','[val_103]'
'x','[val_103]'
'x','[val_103]'
'x','[val_103]'
'x','[val_11]'
'x','[val_11]'
'x','[val_11]'
'x','[val_114]'
'x','[val_114]'
20 rows selected 
>>>  -- no sufficient files
>>>  select key, value, split(value,',') as value_new from gl_src1 ORDER BY key ASC, value ASC, value_new[0] ASC limit 30;
'key','value','value_new'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'0','val_0','[val_0]'
'4','val_4','[val_4]'
'4','val_4','[val_4]'
'4','val_4','[val_4]'
'8','val_8','[val_8]'
'8','val_8','[val_8]'
'8','val_8','[val_8]'
'11','val_11','[val_11]'
'11','val_11','[val_11]'
'11','val_11','[val_11]'
'15','val_15','[val_15]'
'15','val_15','[val_15]'
'15','val_15','[val_15]'
'15','val_15','[val_15]'
'15','val_15','[val_15]'
'15','val_15','[val_15]'
'19','val_19','[val_19]'
'19','val_19','[val_19]'
'19','val_19','[val_19]'
'26','val_26','[val_26]'
'26','val_26','[val_26]'
'26','val_26','[val_26]'
30 rows selected 
>>>  -- need all files
>>>  select key from gl_src1 ORDER BY key ASC limit 100;
'key'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'4'
'4'
'4'
'8'
'8'
'8'
'11'
'11'
'11'
'15'
'15'
'15'
'15'
'15'
'15'
'19'
'19'
'19'
'26'
'26'
'26'
'26'
'26'
'26'
'33'
'33'
'33'
'37'
'37'
'37'
'37'
'37'
'37'
'44'
'44'
'44'
'51'
'51'
'51'
'51'
'51'
'51'
'66'
'66'
'66'
'77'
'77'
'77'
'80'
'80'
'80'
'84'
'84'
'84'
'84'
'84'
'84'
'95'
'95'
'95'
'95'
'95'
'95'
'103'
'103'
'103'
'103'
'103'
'103'
'114'
'114'
'114'
'118'
'118'
'118'
'118'
'118'
'118'
'125'
'125'
'125'
'125'
'125'
'125'
'129'
'129'
'129'
'129'
'129'
'129'
'136'
100 rows selected 
>>>  set hive.limit.optimize.limit.file=4;
No rows affected 
>>>  select key from gl_src1 ORDER BY key ASC limit 30;
'key'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'4'
'4'
'4'
'8'
'8'
'8'
'11'
'11'
'11'
'15'
'15'
'15'
'15'
'15'
'15'
'19'
'19'
'19'
'26'
'26'
'26'
30 rows selected 
>>>  
>>>  -- not qualified cases
>>>  select key, count(1) from gl_src1 group by key ORDER BY key ASC limit 5;
'key','_c1'
'0','9'
'4','3'
'8','3'
'11','3'
'15','6'
5 rows selected 
>>>  select distinct key from gl_src1 ORDER BY key ASC limit 10;
'key'
'0'
'4'
'8'
'11'
'15'
'19'
'26'
'33'
'37'
'44'
10 rows selected 
>>>  select count(1) from gl_src1 limit 1;
'_c0'
'354'
1 row selected 
>>>  select transform(*) using "tr _ \n" as t from 
(select "a_a_a_a_a_a_" from gl_src1 limit 100) subq ORDER BY t;
't'
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
''
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
'a'
700 rows selected 
>>>  select key from (select * from (select key,value from gl_src1)t1 limit 10)t2 ORDER BY key ASC limit 2000;
'key'
'37'
'66'
'150'
'165'
'213'
'224'
'327'
'374'
'484'
'495'
10 rows selected 
>>>  
>>>  -- complicated queries
>>>  select key from (select * from (select key,value from gl_src1 limit 10)t1 )t2 ORDER BY key ASC;
'key'
'37'
'66'
'150'
'165'
'213'
'224'
'327'
'374'
'484'
'495'
10 rows selected 
>>>  select key from (select * from (select key,value from gl_src1)t1 limit 10)t2 ORDER BY key ASC;
'key'
'37'
'66'
'150'
'165'
'213'
'224'
'327'
'374'
'484'
'495'
10 rows selected 
>>>  insert overwrite table gl_tgt select key+1 from (select * from (select key,value from gl_src1)t1)t2 limit 10;
'_c0'
No rows selected 
>>>  select * from gl_tgt ORDER BY key ASC;
'key'
'38'
'67'
'151'
'166'
'214'
'225'
'328'
'375'
'485'
'496'
10 rows selected 
>>>  
>>>  -- empty table
>>>  create table gl_src2 (key int, value string) stored as textfile;
No rows affected 
>>>  select key from gl_src2 ORDER BY key ASC limit 10;
'key'
No rows selected 
>>>  
>>>  -- partition
>>>  create table gl_src_part1 (key int, value string) partitioned by (p string) stored as textfile;
No rows affected 
>>>  load data local inpath '../data/files/srcbucket21.txt' INTO TABLE gl_src_part1 partition(p='11');
No rows affected 
>>>  load data local inpath '../data/files/srcbucket20.txt' INTO TABLE gl_src_part1 partition(p='12');
No rows affected 
>>>  load data local inpath '../data/files/srcbucket20.txt' INTO TABLE gl_src_part1 partition(p='12');
No rows affected 
>>>  load data local inpath '../data/files/srcbucket20.txt' INTO TABLE gl_src_part1 partition(p='12');
No rows affected 
>>>  
>>>  select key from gl_src_part1 where p like '1%' ORDER BY key ASC limit 10;
'key'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'4'
10 rows selected 
>>>  select key from gl_src_part1 where p='11' ORDER BY key ASC limit 10;
'key'
'5'
'5'
'5'
'9'
'12'
'12'
'27'
'30'
'34'
'41'
10 rows selected 
>>>  select key from gl_src_part1 where p='12' ORDER BY key ASC limit 10;
'key'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'4'
10 rows selected 
>>>  select key from gl_src_part1 where p='13' ORDER BY key ASC limit 10;
'key'
No rows selected 
>>>  alter table gl_src_part1 add partition (p='13');
No rows affected 
>>>  select key from gl_src_part1 where p='13' ORDER BY key ASC limit 10;
'key'
No rows selected 
>>>  select key from gl_src_part1 where p='12' ORDER BY key ASC limit 1000;
'key'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'0'
'4'
'4'
'4'
'8'
'8'
'8'
'11'
'11'
'11'
'15'
'15'
'15'
'15'
'15'
'15'
'19'
'19'
'19'
'26'
'26'
'26'
'26'
'26'
'26'
'33'
'33'
'33'
'37'
'37'
'37'
'37'
'37'
'37'
'44'
'44'
'44'
'51'
'51'
'51'
'51'
'51'
'51'
'66'
'66'
'66'
'77'
'77'
'77'
'80'
'80'
'80'
'84'
'84'
'84'
'84'
'84'
'84'
'95'
'95'
'95'
'95'
'95'
'95'
'103'
'103'
'103'
'103'
'103'
'103'
'114'
'114'
'114'
'118'
'118'
'118'
'118'
'118'
'118'
'125'
'125'
'125'
'125'
'125'
'125'
'129'
'129'
'129'
'129'
'129'
'129'
'136'
'136'
'136'
'143'
'143'
'143'
'150'
'150'
'150'
'158'
'158'
'158'
'165'
'165'
'165'
'165'
'165'
'165'
'169'
'169'
'169'
'169'
'169'
'169'
'169'
'169'
'169'
'169'
'169'
'169'
'172'
'172'
'172'
'172'
'172'
'172'
'176'
'176'
'176'
'176'
'176'
'176'
'183'
'183'
'183'
'187'
'187'
'187'
'187'
'187'
'187'
'187'
'187'
'187'
'190'
'190'
'190'
'194'
'194'
'194'
'202'
'202'
'202'
'213'
'213'
'213'
'213'
'213'
'213'
'217'
'217'
'217'
'217'
'217'
'217'
'224'
'224'
'224'
'224'
'224'
'224'
'228'
'228'
'228'
'235'
'235'
'235'
'239'
'239'
'239'
'239'
'239'
'239'
'242'
'242'
'242'
'242'
'242'
'242'
'257'
'257'
'257'
'260'
'260'
'260'
'275'
'275'
'275'
'282'
'282'
'282'
'282'
'282'
'282'
'286'
'286'
'286'
'305'
'305'
'305'
'309'
'309'
'309'
'309'
'309'
'309'
'316'
'316'
'316'
'316'
'316'
'316'
'316'
'316'
'316'
'323'
'323'
'323'
'327'
'327'
'327'
'327'
'327'
'327'
'327'
'327'
'327'
'338'
'338'
'338'
'341'
'341'
'341'
'345'
'345'
'345'
'356'
'356'
'356'
'367'
'367'
'367'
'367'
'367'
'367'
'374'
'374'
'374'
'378'
'378'
'378'
'389'
'389'
'389'
'392'
'392'
'392'
'396'
'396'
'396'
'396'
'396'
'396'
'396'
'396'
'396'
'400'
'400'
'400'
'404'
'404'
'404'
'404'
'404'
'404'
'411'
'411'
'411'
'419'
'419'
'419'
'437'
'437'
'437'
'444'
'444'
'444'
'448'
'448'
'448'
'455'
'455'
'455'
'459'
'459'
'459'
'459'
'459'
'459'
'462'
'462'
'462'
'462'
'462'
'462'
'466'
'466'
'466'
'466'
'466'
'466'
'466'
'466'
'466'
'477'
'477'
'477'
'480'
'480'
'480'
'480'
'480'
'480'
'480'
'480'
'480'
'484'
'484'
'484'
'491'
'491'
'491'
'495'
'495'
'495'
354 rows selected 
>>>  
>>>  drop table gl_src1;
No rows affected 
>>>  drop table gl_src2;
No rows affected 
>>>  drop table gl_src_part1;
No rows affected 
>>>  drop table gl_tgt;
No rows affected 
>>>  !record
